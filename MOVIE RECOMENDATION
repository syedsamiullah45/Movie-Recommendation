pip install scikit-surprise

# Import necessary libraries
from surprise import Dataset, Reader, SVD
from surprise.model_selection import train_test_split
from surprise import accuracy
from surprise.dataset import DatasetAutoFolds

# Load the MovieLens dataset
# You can download it from: https://grouplens.org/datasets/movielens/
# I assume you have 'ratings.csv' file in the current directory
file_path = 'ratings.csv'
reader = Reader(line_format='user item rating timestamp', sep=',', rating_scale=(1, 5))
data = Dataset.load_from_file(file_path, reader=reader)

# Split the dataset into training and testing sets
trainset, testset = train_test_split(data, test_size=0.25, random_state=42)

# Build and train the collaborative filtering model (SVD algorithm)
model = SVD()
model.fit(trainset)

# Make predictions on the test set
predictions = model.test(testset)

# Evaluate the model's performance
accuracy.rmse(predictions)

# Recommend movies for a specific user (user with user_id = 1)
user_id = 1
user_ratings = []
for movie_id in range(1, 11):  # Recommend top 10 movies
    prediction = model.predict(user_id, movie_id)
    user_ratings.append((prediction.est, movie_id))

# Sort the recommended movies by estimated rating in descending order
user_ratings.sort(reverse=True)
print(f"Top 10 movie recommendations for user {user_id}:")
for rating, movie_id in user_ratings:
    print(f"Movie ID: {movie_id}, Estimated Rating: {rating}")
